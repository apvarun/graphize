import{r as t,l as W,H as y}from"./index-CR89p46g.js";var T={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},X=T,ee={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},te=ee;function re({children:r}){return y.createElement("div",{style:te.container},r)}var ne=re,ue=ne;function ie({width:r,height:i,isEditorReady:o,loading:u,_ref:p,className:h,wrapperProps:w}){return y.createElement("section",{style:{...X.wrapper,width:r,height:i},...w},!o&&y.createElement(ue,null,u),y.createElement("div",{ref:p,style:{...X.fullWidth,...!o&&X.hide},className:h}))}var oe=ie,Z=t.memo(oe);function ae(r){t.useEffect(r,[])}var Y=ae;function ce(r,i,o=!0){let u=t.useRef(!0);t.useEffect(u.current||!o?()=>{u.current=!1}:r,i)}var m=ce;function U(){}function x(r,i,o,u){return le(r,u)||se(r,i,o,u)}function le(r,i){return r.editor.getModel(q(r,i))}function se(r,i,o,u){return r.editor.createModel(i,o,u?q(r,u):void 0)}function q(r,i){return r.Uri.parse(i)}function de({original:r,modified:i,language:o,originalLanguage:u,modifiedLanguage:p,originalModelPath:h,modifiedModelPath:w,keepCurrentOriginalModel:L=!1,keepCurrentModifiedModel:$=!1,theme:R="light",loading:H="Loading...",options:E={},height:j="100%",width:A="100%",className:B,wrapperProps:G={},beforeMount:J=U,onMount:Q=U}){let[M,b]=t.useState(!1),[S,d]=t.useState(!0),f=t.useRef(null),s=t.useRef(null),P=t.useRef(null),g=t.useRef(Q),a=t.useRef(J),C=t.useRef(!1);Y(()=>{let e=W.init();return e.then(c=>(s.current=c)&&d(!1)).catch(c=>(c==null?void 0:c.type)!=="cancelation"&&console.error("Monaco initialization: error:",c)),()=>f.current?D():e.cancel()}),m(()=>{if(f.current&&s.current){let e=f.current.getOriginalEditor(),c=x(s.current,r||"",u||o||"text",h||"");c!==e.getModel()&&e.setModel(c)}},[h],M),m(()=>{if(f.current&&s.current){let e=f.current.getModifiedEditor(),c=x(s.current,i||"",p||o||"text",w||"");c!==e.getModel()&&e.setModel(c)}},[w],M),m(()=>{let e=f.current.getModifiedEditor();e.getOption(s.current.editor.EditorOption.readOnly)?e.setValue(i||""):i!==e.getValue()&&(e.executeEdits("",[{range:e.getModel().getFullModelRange(),text:i||"",forceMoveMarkers:!0}]),e.pushUndoStop())},[i],M),m(()=>{var e,c;(c=(e=f.current)==null?void 0:e.getModel())==null||c.original.setValue(r||"")},[r],M),m(()=>{let{original:e,modified:c}=f.current.getModel();s.current.editor.setModelLanguage(e,u||o||"text"),s.current.editor.setModelLanguage(c,p||o||"text")},[o,u,p],M),m(()=>{var e;(e=s.current)==null||e.editor.setTheme(R)},[R],M),m(()=>{var e;(e=f.current)==null||e.updateOptions(E)},[E],M);let I=t.useCallback(()=>{var V;if(!s.current)return;a.current(s.current);let e=x(s.current,r||"",u||o||"text",h||""),c=x(s.current,i||"",p||o||"text",w||"");(V=f.current)==null||V.setModel({original:e,modified:c})},[o,i,p,r,u,h,w]),F=t.useCallback(()=>{var e;!C.current&&P.current&&(f.current=s.current.editor.createDiffEditor(P.current,{automaticLayout:!0,...E}),I(),(e=s.current)==null||e.editor.setTheme(R),b(!0),C.current=!0)},[E,R,I]);t.useEffect(()=>{M&&g.current(f.current,s.current)},[M]),t.useEffect(()=>{!S&&!M&&F()},[S,M,F]);function D(){var c,V,k,N;let e=(c=f.current)==null?void 0:c.getModel();L||((V=e==null?void 0:e.original)==null||V.dispose()),$||((k=e==null?void 0:e.modified)==null||k.dispose()),(N=f.current)==null||N.dispose()}return y.createElement(Z,{width:A,height:j,isEditorReady:M,loading:H,_ref:P,className:B,wrapperProps:G})}var fe=de,Ee=t.memo(fe);function ge(){let[r,i]=t.useState(W.__getMonacoInstance());return Y(()=>{let o;return r||(o=W.init(),o.then(u=>{i(u)})),()=>o==null?void 0:o.cancel()}),r}var Re=ge;function pe(r){let i=t.useRef();return t.useEffect(()=>{i.current=r},[r]),i.current}var he=pe,z=new Map;function Me({defaultValue:r,defaultLanguage:i,defaultPath:o,value:u,language:p,path:h,theme:w="light",line:L,loading:$="Loading...",options:R={},overrideServices:H={},saveViewState:E=!0,keepCurrentModel:j=!1,width:A="100%",height:B="100%",className:G,wrapperProps:J={},beforeMount:Q=U,onMount:M=U,onChange:b,onValidate:S=U}){let[d,f]=t.useState(!1),[s,P]=t.useState(!0),g=t.useRef(null),a=t.useRef(null),C=t.useRef(null),I=t.useRef(M),F=t.useRef(Q),D=t.useRef(),e=t.useRef(u),c=he(h),V=t.useRef(!1),k=t.useRef(!1);Y(()=>{let n=W.init();return n.then(l=>(g.current=l)&&P(!1)).catch(l=>(l==null?void 0:l.type)!=="cancelation"&&console.error("Monaco initialization: error:",l)),()=>a.current?K():n.cancel()}),m(()=>{var l,v,_,O;let n=x(g.current,r||u||"",i||p||"",h||o||"");n!==((l=a.current)==null?void 0:l.getModel())&&(E&&z.set(c,(v=a.current)==null?void 0:v.saveViewState()),(_=a.current)==null||_.setModel(n),E&&((O=a.current)==null||O.restoreViewState(z.get(h))))},[h],d),m(()=>{var n;(n=a.current)==null||n.updateOptions(R)},[R],d),m(()=>{!a.current||u===void 0||(a.current.getOption(g.current.editor.EditorOption.readOnly)?a.current.setValue(u):u!==a.current.getValue()&&(k.current=!0,a.current.executeEdits("",[{range:a.current.getModel().getFullModelRange(),text:u,forceMoveMarkers:!0}]),a.current.pushUndoStop(),k.current=!1))},[u],d),m(()=>{var l,v;let n=(l=a.current)==null?void 0:l.getModel();n&&p&&((v=g.current)==null||v.editor.setModelLanguage(n,p))},[p],d),m(()=>{var n;L!==void 0&&((n=a.current)==null||n.revealLine(L))},[L],d),m(()=>{var n;(n=g.current)==null||n.editor.setTheme(w)},[w],d);let N=t.useCallback(()=>{var n;if(!(!C.current||!g.current)&&!V.current){F.current(g.current);let l=h||o,v=x(g.current,u||r||"",i||p||"",l||"");a.current=(n=g.current)==null?void 0:n.editor.create(C.current,{model:v,automaticLayout:!0,...R},H),E&&a.current.restoreViewState(z.get(l)),g.current.editor.setTheme(w),L!==void 0&&a.current.revealLine(L),f(!0),V.current=!0}},[r,i,o,u,p,h,R,H,E,w,L]);t.useEffect(()=>{d&&I.current(a.current,g.current)},[d]),t.useEffect(()=>{!s&&!d&&N()},[s,d,N]),e.current=u,t.useEffect(()=>{var n,l;d&&b&&((n=D.current)==null||n.dispose(),D.current=(l=a.current)==null?void 0:l.onDidChangeModelContent(v=>{k.current||b(a.current.getValue(),v)}))},[d,b]),t.useEffect(()=>{if(d){let n=g.current.editor.onDidChangeMarkers(l=>{var _;let v=(_=a.current.getModel())==null?void 0:_.uri;if(v&&l.find(O=>O.path===v.path)){let O=g.current.editor.getModelMarkers({resource:v});S==null||S(O)}});return()=>{n==null||n.dispose()}}return()=>{}},[d,S]);function K(){var n,l;(n=D.current)==null||n.dispose(),j?E&&z.set(h,a.current.saveViewState()):(l=a.current.getModel())==null||l.dispose(),a.current.dispose()}return y.createElement(Z,{width:A,height:B,isEditorReady:d,loading:$,_ref:C,className:G,wrapperProps:J})}var ve=Me,me=t.memo(ve),Le=me;export{Ee as DiffEditor,me as Editor,Le as default,W as loader,Re as useMonaco};
